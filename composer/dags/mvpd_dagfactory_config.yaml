configs:
  monitoring:
    file: monitoring/checks_all.yaml
  sub_dags:
    pds:
      - dag_id: "mvpd_data.mvpd_nyi_dma"
        tags: ["mvpd", "nyi", "prod"]
        input_bucket: "nyi-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/Reporting"
          file_pattern: "inbound/Reporting/Co-mingled_NYI_Finecast*"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY"}
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_nyi_dma_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_nyi.sql"
        aggregation_tables:
          mvpd_dma: "mvpd_nyi_dma_agg.sql"
          mvpd_network: "mvpd_nyi_line_item_agg.sql"
          mvpd_lineitem: "mvpd_nyi_network_agg.sql"

        skip_source_file_ingestion: False
        data_check:
          data_check_flag: True
          data_check_sql_path: "nyi_dma.sql"
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_NYI_DMA_STG"
          pds_table: "P_NEXUS_MVPD_NYI_DMA"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_nyi_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_nyi.sql"
          stage_name: "NEXUS_MVPD_NYI_PRD"
          folderpath : "preprocessing"
          snowflake_aggregation_tables:
            mvpd_dma: "snowflake/p_nexus_mvpd_nyi_dma_agg.sql"
            mvpd_network: "snowflake/p_nexus_mvpd_nyi_network_agg.sql"
            mvpd_lineitem: "snowflake/p_nexus_mvpd_nyi_line_item_agg.sql"


      - dag_id: "mvpd_data.mvpd_spectrum"
        tags: ["mvpd", "spectrum", "prod"]
        input_bucket: "spectrum-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/"
          file_pattern: "inbound/Nexus Monday Detail Reporting*"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY"}
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_spectrum_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_spectrum.sql"
        aggregation_tables:
          mvpd_dma: "mvpd_spectrum_dma_agg.sql"
          mvpd_network: "mvpd_spectrum_network_agg.sql"
          mvpd_lineitem: "mvpd_spectrum_line_item_agg.sql"

        skip_source_file_ingestion: False
        data_check:
          data_check_flag: True
          data_check_sql_path : "spectrum.sql"
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_SPECTRUM_STG"
          pds_table: "P_NEXUS_MVPD_SPECTRUM"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_spectrum_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_spectrum.sql"
          stage_name: "NEXUS_MVPD_SPECTRUM_PRD"
          folderpath : "preprocessing"
          snowflake_aggregation_tables:
            mvpd_dma: "snowflake/p_nexus_mvpd_spectrum_dma_agg.sql"
            mvpd_network: "snowflake/p_nexus_mvpd_spectrum_network_agg.sql"
            mvpd_lineitem: "snowflake/p_nexus_mvpd_spectrum_line_item_agg.sql"

      - dag_id: "mvpd_data.mvpd_DirectTV_dma"
        tags: ["mvpd", "DTV", "prod"]
        input_bucket: "directv-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/"
          file_pattern: "inbound/S3_DTV-Weekly-DMA_FINECAST_*"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY"}
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_DirectTV_dma_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_directv.sql"
        aggregation_tables:
          mvpd_dma: "mvpd_directv_dma_agg.sql"
          mvpd_lineitem: "mvpd_directv_line_item_agg.sql"

        skip_source_file_ingestion: False
        data_check:
          data_check_flag: True
          data_check_sql_path: "dtv_dma.sql"
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_DIRECTTV_DMA_STG"
          pds_table: "P_NEXUS_MVPD_DIRECTTV_DMA"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_directv_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_directv.sql"
          stage_name: "NEXUS_MVPD_DIRECTTV_PRD"
          folderpath : "preprocessing"
          snowflake_aggregation_tables:
            mvpd_dma: "snowflake/p_nexus_mvpd_directv_dma_agg.sql"
            mvpd_lineitem: "snowflake/p_nexus_mvpd_directv_line_item_agg.sql"

      - dag_id: "mvpd_data.mvpd_directtv_network"
        tags: ["mvpd", "DTV", "prod"]
        input_bucket: "directv-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/"
          file_pattern: "inbound/S3_DTV-Weekly-Network_FINECAST_*"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY"}
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_directtv_network_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_directv_network.sql"
        aggregation_tables:
          mvpd_network: "mvpd_directv_network_agg.sql"

        skip_source_file_ingestion: False
        data_check:
          data_check_flag: True
          data_check_sql_path: "dtv_network.sql"
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_DIRECTTV_NETWORK_STG"
          pds_table: "P_NEXUS_MVPD_DIRECTTV_NETWORK"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_directv_network_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_directv_network.sql"
          stage_name: "NEXUS_MVPD_DIRECTTV_PRD"
          folderpath : "preprocessing"
          snowflake_aggregation_tables:
            mvpd_network: "snowflake/p_nexus_mvpd_directv_network_agg.sql"

      - dag_id: "mvpd_data.mvpd_np_comcast_dma"
        tags: ["mvpd", "COMCAST", "prod"]
        input_bucket: "comcast-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/"
          file_pattern: "inbound/linear_addressable/report_name=DMA/*.csv"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY"}
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_np_comcast_dma_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_np_comcast_dma.sql"
        aggregation_tables:
          mvpd_dma: "mvpd_np_comcast_dma_agg.sql"

        skip_source_file_ingestion: False
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_NP_COMCAST_DMA_STG"
          pds_table: "P_NEXUS_MVPD_NP_COMCAST_DMA"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_np_comcast_dma_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_np_comcast_dma.sql"
          stage_name: "NEXUS_MVPD_NP_COMCAST_PRD"
          folderpath : "preprocessing/linear_addressable/report_name=DMA/date=2025-03-30"

      - dag_id: "mvpd_data.mvpd_np_comcast_order"
        tags: ["mvpd", "COMCAST", "prod"]
        input_bucket: "comcast-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/"
          file_pattern: "inbound/linear_addressable/report_name=Order/*.csv"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY"}
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_np_comcast_order_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_np_comcast_order.sql"
        aggregation_tables:
          mvpd_lineitem: "mvpd_np_comcast_line_item_agg.sql"

        skip_source_file_ingestion: False
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_NP_COMCAST_ORDER_STG"
          pds_table: "P_NEXUS_MVPD_NP_COMCAST_ORDER"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_np_comcast_order_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_np_comcast_order.sql"
          stage_name: "NEXUS_MVPD_NP_COMCAST_PRD"
          folderpath : "preprocessing/linear_addressable/report_name=Order"

      - dag_id: "mvpd_data.mvpd_np_comcast_hour"
        tags: ["mvpd", "COMCAST", "prod"]
        input_bucket: "comcast-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/"
          file_pattern: "inbound/linear_addressable/report_name=Hour/*.csv"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY"}
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_np_comcast_hour_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_np_comcast_hour.sql"
        skip_source_file_ingestion: False
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_NP_COMCAST_HOUR_STG"
          pds_table: "P_NEXUS_MVPD_NP_COMCAST_HOUR"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_np_comcast_hour_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_np_comcast_hour.sql"
          stage_name: "NEXUS_MVPD_NP_COMCAST_PRD"
          folderpath : "preprocessing/linear_addressable/report_name=Hour"

      - dag_id: "mvpd_data.mvpd_np_comcast_video_completion"
        tags: ["mvpd", "COMCAST", "prod"]
        input_bucket: "comcast-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/"
          file_pattern: "inbound/linear_addressable/report_name=Video_Completion/*.csv"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY"}
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_np_comcast_video_completion_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_np_comcast_video_completion.sql"
        skip_source_file_ingestion: False
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_NP_COMCAST_VIDEO_COMPLETION_STG"
          pds_table: "P_NEXUS_MVPD_NP_COMCAST_VIDEO_COMPLETION"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_np_comcast_video_completion_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_np_comcast_video_completion.sql"
          stage_name: "NEXUS_MVPD_NP_COMCAST_PRD"
          folderpath : "preprocessing/linear_addressable/report_name=video_completion"     

      - dag_id: "mvpd_data.mvpd_np_comcast_creative"
        tags: ["mvpd", "COMCAST", "prod"]
        input_bucket: "comcast-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/"
          file_pattern: "inbound/linear_addressable/report_name=Creative/*.csv"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY"}
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_np_comcast_creative_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_np_comcast_creative.sql"
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_NP_COMCAST_CREATIVE_STG"
          pds_table: "P_NEXUS_MVPD_NP_COMCAST_CREATIVE"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_np_comcast_creative_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_np_comcast_creative.sql"
          stage_name: "NEXUS_MVPD_NP_COMCAST_PRD"
          folderpath : "preprocessing/linear_addressable/report_name=Creative"

      - dag_id: "mvpd_data.mvpd_np_comcast_network"
        tags: ["mvpd", "COMCAST", "prod"]
        input_bucket: "comcast-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/"
          file_pattern: "inbound/linear_addressable/report_name=Network/*.csv"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY"}
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_np_comcast_network_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_np_comcast_network.sql"
        aggregation_tables:
          mvpd_network: "mvpd_np_comcast_network_agg.sql"

        skip_source_file_ingestion: False
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_NP_COMCAST_NETWORK_STG"
          pds_table: "P_NEXUS_MVPD_NP_COMCAST_NETWORK"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_np_comcast_network_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_np_comcast_network.sql"
          stage_name: "NEXUS_MVPD_NP_COMCAST_PRD"
          folderpath : "preprocessing/linear_addressable/report_name=Network"

      - dag_id: "mvpd_data.mvpd_dishtv_day"
        tags: [ "mvpd", "DISH", "prod" ]
        input_bucket: "dish-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/"
          file_pattern: "inbound/finecast_imps_by_day_[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9].csv"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY" }
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_dishtv_day_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_dishtv_day.sql"
        skip_source_file_ingestion: False
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_DISHTV_DAY_STG"
          pds_table: "P_NEXUS_MVPD_DISHTV_DAY"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_dishtv_day_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_dishtv_day.sql"
          stage_name: "NEXUS_MVPD_DISH_PRD"
          folderpath: "preprocessing"


      - dag_id: "mvpd_data.mvpd_dishtv_network_hour"
        tags: [ "mvpd", "DISH", "prod" ]
        input_bucket: "dish-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/"
          file_pattern: "inbound/finecast_imps_by_day_network_hour_*.csv"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY" }
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_dishtv_network_hour_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_dishtv_network_hour.sql"
        skip_source_file_ingestion: False
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_DISHTV_NETWORK_HOUR_STG"
          pds_table: "P_NEXUS_MVPD_DISHTV_NETWORK_HOUR"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_dishtv_network_hour_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_dishtv_network_hour.sql"
          stage_name: "NEXUS_MVPD_DISH_PRD"
          folderpath: "preprocessing"


      - dag_id: "mvpd_data.mvpd_dishtv_dma_creative"
        tags: [ "mvpd", "DISH", "prod" ]
        input_bucket: "dish-landing"
        source_file:
          storage_type: "gcs"
          prefix: "inbound/"
          file_pattern: "inbound/finecast_imps_by_day_dma_creative_*.csv"
          dttm_pattern: ""
          field_delimiter: ","
          quote_character: '"'
          skip_leading_rows: 1
          gcs_sensor_poke_interval: 10
          gcs_sensor_timeout: 30
          is_excel: False
          skip_if_no_files: True
          ignore_date_check: True
          fileprocessday: { "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY" ,"SUNDAY" }
        staging_table:
          name: "${project_id}.mvpd_data.mvpd_dishtv_dma_creative_stg"
          load_method: "WRITE_TRUNCATE"
        pds_load_sql_path: "mvpd_dishtv_dma_creative.sql"
        aggregation_tables:
          mvpd_dma: "mvpd_dishtv_dma_creative_agg.sql"
        skip_source_file_ingestion: False
        snowflake_active: True
        snowflake:
          database: "NEXUS_DATAPLATFORM"
          schema: "P_MVPD"
          stg_table: "P_NEXUS_MVPD_DISHTV_DMA_CREATIVE_STG"
          pds_table: "P_NEXUS_MVPD_DISHTV_DMA_CREATIVE"
          load_staging_table_sql: "snowflake/p_nexus_mvpd_dishtv_dma_creative_stg.sql"
          load_main_table_sql: "snowflake/p_nexus_mvpd_dishtv_dma_creative.sql"
          stage_name: "NEXUS_MVPD_DISH_PRD"
          folderpath: "preprocessing"

  orchestration:
    schedule: "0 8 * * *"